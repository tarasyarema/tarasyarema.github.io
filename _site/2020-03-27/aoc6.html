<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Advent Of Corona: Day 6 | tarasyarema</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Advent Of Corona: Day 6" />
<meta name="author" content="Taras Yarema" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This post is about the day 6 problem of the Advent Of Corona challenge." />
<meta property="og:description" content="This post is about the day 6 problem of the Advent Of Corona challenge." />
<link rel="canonical" href="http://localhost:4000/2020-03-27/aoc6" />
<meta property="og:url" content="http://localhost:4000/2020-03-27/aoc6" />
<meta property="og:site_name" content="tarasyarema" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-27T11:00:00+01:00" />
<script type="application/ld+json">
{"headline":"Advent Of Corona: Day 6","dateModified":"2020-03-27T11:00:00+01:00","datePublished":"2020-03-27T11:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020-03-27/aoc6"},"author":{"@type":"Person","name":"Taras Yarema"},"description":"This post is about the day 6 problem of the Advent Of Corona challenge.","url":"http://localhost:4000/2020-03-27/aoc6","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="tarasyarema" />

  <!-- Analytics-->
  <script async defer data-domain="tarasyarema.com" src="https://plausible.io/js/plausible.js"></script>

</head>


  <body>

    <nav class="nav">
  <div class="nav-container">
    <a href="/">
      <h2 class="nav-title">tarasyarema</h2>
    </a>
    <ul>
      <li><a href="/assets/files/cv.pdf" target="_blank">CV</a></li>
      <li><a href="https://github.com/tarasyarema/" target="_blank">Github</a></li>
      <!-- <li><a href="/about">About</a></li> -->
      <li><a href="/">Posts</a></li>
    </ul>
  </div>
</nav>


    <main>
      <div class="post">
  <div class="post-info">
    <span>Written by</span>
    
        Taras Yarema
    

    
      <br>
      <span>on&nbsp;</span><time datetime="2020-03-27 11:00:00 +0100">March 27, 2020</time>
    
  </div>

  <h1 class="post-title">Advent Of Corona: Day 6</h1>
  <div class="post-line"></div>

  <p>This post is about the <a href="https://adventofcorona.hackersatupc.org/#/problem/6">day 6 problem of the Advent Of Corona challenge</a>.</p>

<h2 id="the-problem">The problem</h2>

<p>You are given a binary named <code class="language-plaintext highlighter-rouge">lagrange_baby</code>. That’s all.</p>

<h2 id="the-solution">The solution</h2>

<p>The first thing to do when you get a binary in a <em>CTF-like</em> challenge like this is taking a look at what bash commands like <code class="language-plaintext highlighter-rouge">file</code> or <code class="language-plaintext highlighter-rouge">strings</code> output you.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>file lagrange_baby
lagrange_baby: ELF 64-bit LSB shared object, x86-64, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, 
dynamically linked, interpreter /lib64/l, 
<span class="k">for </span>GNU/Linux 3.2.0, BuildID[sha1]<span class="o">=</span>76154f43151d7962511001b781c47a617a01b9bd, 
not stripped
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>strings <span class="nt">-d</span> lagrange_baby
/lib64/ld-linux-x86-64.so.2
libc.so.6
srand
__isoc99_scanf
puts
__stack_chk_fail
<span class="nb">printf
</span>strlen
malloc
__cxa_finalize
__libc_start_main
free
GLIBC_2.7
GLIBC_2.4
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
gfff
gfff
VUUU
VUUU
AWAVI
AUATL
<span class="o">[]</span>A<span class="se">\A</span><span class="o">]</span>A^A_
noup
still noup
aaaaaaaaand stil noup
flag<span class="o">{</span><span class="se">\%</span>s<span class="o">}</span>
<span class="p">;</span><span class="k">*</span>3<span class="s2">$"
</span></code></pre></div></div>

<p>From these outputs we know the following things:</p>

<ul>
  <li>The binary is Linux <code class="language-plaintext highlighter-rouge">x64</code> executable.</li>
  <li>There are some interesting strings: <code class="language-plaintext highlighter-rouge">noup</code>, <code class="language-plaintext highlighter-rouge">still noup</code>, <code class="language-plaintext highlighter-rouge">aaaaaaaaand stil noup</code> and <code class="language-plaintext highlighter-rouge">flag{\%s}</code>.
  There is nothing similar to a flag inside it, so I can suppose that it’s generated in execution time.</li>
</ul>

<p>Let’s take a deeper look into the binary. I choose Ghidra, but it can be done in any other GUI or terminal tool (r2, cutter, ida, …).</p>

<h3 id="playing-around">Playing around</h3>

<p>Before doing anything we will try to mess around with the binary:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./lagrange_baby
a
noup
<span class="nv">$ </span>./lagrange_baby
1
noup
<span class="nv">$ </span>./lagrange_baby
aaaaaaaaaaaaaaaaaaa
noup
</code></pre></div></div>

<p>Hm, interesting…</p>

<h3 id="reversing-with-ghidra">Reversing with Ghidra</h3>

<p>The basic steps to begin analyzing a binary are the following:</p>

<h4 id="import-the-binary">Import the binary</h4>

<p>Pretty straight-forward.</p>

<p><img src="/assets/img/aoc6-1.PNG" alt="Import" /></p>

<h4 id="analyze-it">Analyze it</h4>

<p>Just analyze all.</p>

<p><img src="/assets/img/aoc6-2.PNG" alt="Analyze" /></p>

<h4 id="reversing">Reversing</h4>

<p>First of all, I look that the functions panel and search for the <code class="language-plaintext highlighter-rouge">main</code> function.
When you click at it it shows up a <em>C-like</em> decompiled view of the function.</p>

<p><img src="/assets/img/aoc6-3.PNG" alt="Main" /></p>

<p>One of the things I like about Ghidra is that it lets you redefine variable types and names. So you can change those definitions during the reversing and the flow is much easier to follow.</p>

<p>The first thing I do is redefine the main function to be <code class="language-plaintext highlighter-rouge">int main (void)</code> and the <code class="language-plaintext highlighter-rouge">__isoc99_scanf</code> to <code class="language-plaintext highlighter-rouge">scanf</code>.
I notice that there are two <code class="language-plaintext highlighter-rouge">scanf</code> in the main function: <code class="language-plaintext highlighter-rouge">00100c17</code> and <code class="language-plaintext highlighter-rouge">00100d2e</code>.
So I redefine the values written to as <code class="language-plaintext highlighter-rouge">input_1</code> and <code class="language-plaintext highlighter-rouge">input_2</code>.</p>

<p><img src="/assets/img/aoc6-4.PNG" alt="Redefine_1" /></p>

<p>We now know the expected types of inputs: <code class="language-plaintext highlighter-rouge">uint input_2</code> and <code class="language-plaintext highlighter-rouge">char *input_2</code>.</p>

<p>As we know that the first input is a positive integer, we return and play around a bit:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./lagrange_baby
0
noup
<span class="nv">$ </span>./lagrange_baby
1
noup
<span class="nv">$ </span>./lagrange_baby
2
noup
<span class="nv">$ </span>./lagrange_baby
3
noup
<span class="nv">$ </span>./lagrange_baby
4
noup
<span class="nv">$ </span>./lagrange_baby
5
noup
<span class="nv">$ </span>./lagrange_baby
6
a
still noup
</code></pre></div></div>

<p>Hm, so <code class="language-plaintext highlighter-rouge">6</code> is an accepted first input. Good, but why?
We will suppose that the function <code class="language-plaintext highlighter-rouge">isprime</code> returns what its name says if the number given as input is prime.
So if we look at the first part of the main function (I renamed some variables to make it more readable) we have the following flow</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">io_input</span><span class="p">,</span><span class="o">&amp;</span><span class="n">input_1</span><span class="p">);</span>
<span class="n">srand</span><span class="p">(</span><span class="n">input_1</span><span class="p">);</span> <span class="c1">// init rand with seed the input value</span>
<span class="n">var_1</span> <span class="o">=</span> <span class="mh">0xd</span><span class="p">;</span>    <span class="c1">// 0xd = 13 in decimal</span>
<span class="k">do</span> <span class="p">{</span>
    <span class="c1">// this while loops var_1 from 13 untill it breaks</span>
    <span class="n">var_1_prime</span> <span class="o">=</span> <span class="n">isprime</span><span class="p">(</span><span class="n">var_1</span><span class="p">);</span> <span class="c1">// Check if the current var_1 is prime</span>
    <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">var_1_prime</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// if its prime we take its remainder mod 10 and check if its prime</span>
        <span class="n">var_1_prime</span> <span class="o">=</span> <span class="n">isprime</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">var_1</span> <span class="o">%</span> <span class="mi">10</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">var_1_prime</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// if it is we take the integer division of var_1 by 10 and</span>
            <span class="c1">// check if is divisble by 3</span>
            <span class="n">var_2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">var_1</span> <span class="o">/</span> <span class="mi">10</span><span class="p">;</span>
            <span class="c1">// then this strange wtf variable comes up...</span>
            <span class="k">if</span> <span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">var_2</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
                <span class="p">(</span><span class="n">wtf</span> <span class="o">=</span> <span class="p">(</span><span class="n">uint</span><span class="p">)((</span><span class="kt">int</span><span class="p">)</span><span class="n">var_2</span> <span class="o">&gt;&gt;</span> <span class="mh">0x1f</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">var_2</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="p">(</span><span class="n">var_2</span> <span class="o">+</span> <span class="n">wtf</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">wtf</span><span class="p">))</span>
                <span class="k">break</span><span class="p">;</span> <span class="c1">// if this strange condition is satisfied we exit the loop</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// var_1++</span>
    <span class="n">var_1</span> <span class="o">=</span> <span class="n">var_1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">);</span>
</code></pre></div></div>

<p>As I do not really understand this loop, I decided to implement a analogy of this in Python:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">isprime</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
  <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">a</span> <span class="o">%</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>

<span class="n">var_1</span> <span class="o">=</span> <span class="mh">0xd</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
  <span class="n">var_1_prime</span> <span class="o">=</span> <span class="n">isprime</span><span class="p">(</span><span class="n">var_1</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">var_1_prime</span><span class="p">:</span>
    <span class="n">var_1_prime</span> <span class="o">=</span> <span class="n">isprime</span><span class="p">(</span><span class="n">var_1</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">var_1_prime</span><span class="p">:</span>
      <span class="n">var_2</span> <span class="o">=</span> <span class="n">var_1</span> <span class="o">//</span> <span class="mi">10</span>
      <span class="n">wtf</span> <span class="o">=</span> <span class="p">(</span><span class="n">var_2</span> <span class="o">&gt;&gt;</span> <span class="mh">0x1f</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mh">0x1f</span>

      <span class="k">if</span> <span class="p">((</span><span class="n">var_2</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">var_2</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="p">(</span><span class="n">var_2</span> <span class="o">+</span> <span class="n">wtf</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">wtf</span><span class="p">)):</span>
        <span class="k">break</span>

  <span class="n">var_1</span> <span class="o">=</span> <span class="n">var_1</span> <span class="o">+</span> <span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="n">var_1</span><span class="p">,</span> <span class="n">var_2</span><span class="p">)</span>
</code></pre></div></div>

<p>When I run it I get this output</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 loop.py
67 6
</code></pre></div></div>

<p>Nice! We know that <code class="language-plaintext highlighter-rouge">var_1=67</code>, and <code class="language-plaintext highlighter-rouge">var_2=6</code>. That’s where the initial <code class="language-plaintext highlighter-rouge">6</code> we found came from.</p>

<p>Let’s take a look at the next condition</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// checks if input_1 is 6</span>
<span class="k">if</span> <span class="p">(</span><span class="n">var_2</span> <span class="o">==</span> <span class="n">input_1</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// input_2 will be 6 *char</span>
    <span class="n">input_2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">((</span><span class="kt">long</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="n">input_1</span><span class="p">);</span>
    <span class="c1">// read input_2</span>
    <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">DAT_00100ea0</span><span class="p">,</span><span class="n">input_2</span><span class="p">);</span>
    <span class="n">input_2_len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">input_2</span><span class="p">);</span>
    <span class="c1">// check if the input_2 is really 6 chars long</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">input_2_len</span> <span class="o">==</span> <span class="p">(</span><span class="kt">long</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="n">input_1</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// init a var_3 to 0, which we will loop while</span>
        <span class="c1">// its less than 6, i.e. var_3 = 0, 1, 2, 3, 4, 5 </span>
        <span class="n">var_3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">var_3</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">input_1</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// pick var_3-th character of the input_2</span>
            <span class="n">char_i</span> <span class="o">=</span> <span class="n">input_2</span><span class="p">[(</span><span class="kt">long</span><span class="p">)</span><span class="n">var_3</span><span class="p">];</span>
            <span class="c1">// evaluate some random function</span>
            <span class="n">epic_function_output</span> <span class="o">=</span> <span class="n">epic_function</span><span class="p">(</span><span class="n">var_3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
            <span class="c1">// check if the current character of the input (in decimal form)</span>
            <span class="c1">// is the same as the function return value</span>
            <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">char_i</span> <span class="o">!=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">epic_function_output</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">puts</span><span class="p">(</span><span class="s">"aaaaaaaaand stil noup"</span><span class="p">);</span>
                <span class="n">free</span><span class="p">(</span><span class="n">input_2</span><span class="p">);</span>
                <span class="n">return_var</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="k">goto</span> <span class="n">LAB_00100def</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">var_3</span> <span class="o">=</span> <span class="n">var_3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"flag{\%s}</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">input_2</span><span class="p">);</span>
        <span class="n">free</span><span class="p">(</span><span class="n">input_2</span><span class="p">);</span>
        <span class="n">return_var</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// the message we got before</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"still noup"</span><span class="p">);</span>
        <span class="n">free</span><span class="p">(</span><span class="n">input_2</span><span class="p">);</span>
        <span class="n">return_var</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Hm, interesting. Let’s try something…</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./lagrange_baby
6
123456
aaaaaaaaand stil noup
<span class="nv">$ </span>./lagrange_baby
6
12345
still noup
<span class="nv">$ </span>./lagrange_baby
6
1234567
still noup
</code></pre></div></div>

<p>Good. The expected <code class="language-plaintext highlighter-rouge">input_2</code> length is really <code class="language-plaintext highlighter-rouge">6</code> characters long. Let’s take a look at the <code class="language-plaintext highlighter-rouge">epic_function</code> then. Doing some basic redefines to be more readable we have this</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ulong</span> <span class="nf">epic_function</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">ulong</span> <span class="n">v1</span><span class="p">;</span>
  <span class="n">ulong</span> <span class="n">v2</span><span class="p">;</span>
  <span class="n">ulong</span> <span class="n">v3</span><span class="p">;</span>
  <span class="n">ulong</span> <span class="n">v4</span><span class="p">;</span>
  
  <span class="c1">// 0x3b9aca01 = 1000000001 in decimal</span>
  <span class="c1">// but what does pow_mod do?</span>
  <span class="n">v1</span> <span class="o">=</span> <span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mh">0x3b9aca01</span><span class="p">);</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mh">0x3b9aca01</span><span class="p">);</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mh">0x3b9aca01</span><span class="p">);</span>
  <span class="n">v4</span> <span class="o">=</span> <span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mh">0x3b9aca01</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">v4</span> <span class="o">&amp;</span> <span class="mh">0xffffffff00000000</span> <span class="o">|</span>
         <span class="p">(</span><span class="n">ulong</span><span class="p">)(</span><span class="n">uint</span><span class="p">)(</span><span class="kt">int</span><span class="p">)(((</span><span class="kt">double</span><span class="p">)</span><span class="n">x</span> <span class="o">*</span> <span class="o">-</span><span class="mi">7657</span><span class="p">.</span><span class="mo">00000000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span>
                            <span class="p">((</span><span class="kt">double</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="n">v4</span> <span class="o">*</span> <span class="mi">10123</span><span class="p">.</span><span class="mo">00000000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span>
                            <span class="p">((</span><span class="kt">double</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="n">v3</span> <span class="o">*</span> <span class="o">-</span><span class="mi">5861</span><span class="p">.</span><span class="mo">00000000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">24</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span>
                            <span class="p">((</span><span class="kt">double</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="n">v2</span> <span class="o">*</span> <span class="mi">389</span><span class="p">.</span><span class="mo">00000000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span>
                            <span class="p">((</span><span class="kt">double</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="n">v1</span> <span class="o">*</span> <span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="mo">00000000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span>
                            <span class="mi">713</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This function seems to do some strange calculations… Let’s take a look at <code class="language-plaintext highlighter-rouge">pow_mod</code></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ulong</span> <span class="nf">pow_mod</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">uint</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">uint</span> <span class="n">v1</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span>
  <span class="n">uint</span> <span class="n">v3</span><span class="p">;</span>
  
  <span class="n">v3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">v1</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">v1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">v1</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">v3</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">v2</span> <span class="o">*</span> <span class="n">v3</span><span class="p">)</span> <span class="o">%</span> <span class="n">z</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v1</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span> <span class="o">*</span> <span class="n">v2</span><span class="p">)</span> <span class="o">%</span> <span class="n">z</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">v3</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Hmm, I’m to lazy to understand this. Let’s try to run it!
I created a C file with the <code class="language-plaintext highlighter-rouge">pow_mod</code> and <code class="language-plaintext highlighter-rouge">epic_function</code> definitions and a simple loop like it does on the <code class="language-plaintext highlighter-rouge">lagrange_baby</code> binary, from <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">5</code>.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
</span>
<span class="kt">int</span> <span class="nf">pow_mod</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span>
  
  <span class="n">v3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">v1</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">v1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">v1</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">v3</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">v2</span> <span class="o">*</span> <span class="n">v3</span><span class="p">)</span> <span class="o">%</span> <span class="n">z</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v1</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span> <span class="o">*</span> <span class="n">v2</span><span class="p">)</span> <span class="o">%</span> <span class="n">z</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v3</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">epic_function</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span>
  
  <span class="c1">// 0x3b9aca01 = 1000000001 in decimal</span>
  <span class="c1">// but what does pow_mod do?</span>
  <span class="n">v1</span> <span class="o">=</span> <span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mh">0x3b9aca01</span><span class="p">);</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mh">0x3b9aca01</span><span class="p">);</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mh">0x3b9aca01</span><span class="p">);</span>
  <span class="n">v4</span> <span class="o">=</span> <span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mh">0x3b9aca01</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">v4</span> <span class="o">&amp;</span> <span class="mh">0xffffffff00000000</span> <span class="o">|</span>
         <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="kt">int</span><span class="p">)(</span><span class="kt">int</span><span class="p">)(((</span><span class="kt">double</span><span class="p">)</span><span class="n">x</span> <span class="o">*</span> <span class="o">-</span><span class="mi">7657</span><span class="p">.</span><span class="mo">00000000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span>
                            <span class="p">((</span><span class="kt">double</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="n">v4</span> <span class="o">*</span> <span class="mi">10123</span><span class="p">.</span><span class="mo">00000000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span>
                            <span class="p">((</span><span class="kt">double</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="n">v3</span> <span class="o">*</span> <span class="o">-</span><span class="mi">5861</span><span class="p">.</span><span class="mo">00000000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">24</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span>
                            <span class="p">((</span><span class="kt">double</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="n">v2</span> <span class="o">*</span> <span class="mi">389</span><span class="p">.</span><span class="mo">00000000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span>
                            <span class="p">((</span><span class="kt">double</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="n">v1</span> <span class="o">*</span> <span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="mo">00000000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span>
                            <span class="mi">713</span><span class="p">.</span><span class="mo">00000000</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"%d %d %c</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">epic_function</span><span class="p">((</span><span class="kt">int</span><span class="p">)(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span> <span class="n">epic_function</span><span class="p">((</span><span class="kt">int</span><span class="p">)(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)));</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Note that I changed all <code class="language-plaintext highlighter-rouge">uint</code> and <code class="language-plaintext highlighter-rouge">ulong</code> to <code class="language-plaintext highlighter-rouge">int</code>. When I compile and execute this I get the following output:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gcc epic.c
<span class="nv">$ </span>./a.out
1 67 C
2 48 0
3 114 r
4 111 o
5 78 N
6 52 4
</code></pre></div></div>

<p>Oh! This look like something. We got the string: <code class="language-plaintext highlighter-rouge">C0r0N4</code>! Let’s try it as second input:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./lagrange_baby
6
C0roN4
flag<span class="o">{</span>C0roN4<span class="o">}</span>
</code></pre></div></div>

<p>Yes! We got it. Not that hard, right?</p>

<h3 id="actual-c-code-for-the-binary">Actual C code for the binary</h3>

<p>If any of you are interested in how I created this challenge, here is the C code that generated it:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;time.h&gt;
</span>
<span class="cp">#define TOO_BIG 1e+9+1
</span>
<span class="kt">int</span> <span class="nf">pow_mod</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

   <span class="k">while</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
         <span class="n">r</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">r</span> <span class="o">%</span> <span class="n">n</span><span class="p">;</span>

      <span class="n">x</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">n</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">epic_function</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">double</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

   <span class="n">s</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">13</span> <span class="o">*</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">TOO_BIG</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span><span class="p">;</span>
   <span class="n">s</span> <span class="o">+=</span> <span class="mi">389</span> <span class="o">*</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TOO_BIG</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">;</span>
   <span class="n">s</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">5861</span> <span class="o">*</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TOO_BIG</span><span class="p">)</span> <span class="o">/</span> <span class="mi">24</span><span class="p">;</span>
   <span class="n">s</span> <span class="o">+=</span> <span class="mi">10123</span> <span class="o">*</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">TOO_BIG</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">;</span>
   <span class="n">s</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">7657</span> <span class="o">*</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">x</span> <span class="o">/</span> <span class="mi">6</span><span class="p">;</span>
   <span class="n">s</span> <span class="o">+=</span> <span class="mi">713</span><span class="p">;</span>

   <span class="k">return</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">s</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">rand_between</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int</span><span class="p">)((</span><span class="kt">double</span><span class="p">)(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rand</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">TOO_BIG</span> <span class="o">+</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">));</span> <span class="p">}</span>

<span class="kt">int</span> <span class="nf">isprime</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">||</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="o">||</span> <span class="o">!</span><span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">))</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

   <span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="o">!</span><span class="p">(</span><span class="n">m</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">);</span> <span class="o">++</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">;</span>

   <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">s</span><span class="p">);</span>

   <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">rand_between</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span>
      <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">pow_mod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">x</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
         <span class="k">continue</span><span class="p">;</span>

      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">r</span><span class="p">)</span>
      <span class="p">{</span>
         <span class="n">x</span> <span class="o">=</span> <span class="n">pow_mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">goto</span> <span class="n">LOOP</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="nl">LOOP:</span>
      <span class="k">continue</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
   <span class="kt">int</span> <span class="n">y</span><span class="p">;</span>

   <span class="n">scanf</span><span class="p">(</span><span class="s">"\%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">);</span>
   <span class="n">srand</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>

   <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">13</span><span class="p">;;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">isprime</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">isprime</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">10</span><span class="p">))</span>
      <span class="p">{</span>
         <span class="kt">int</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">i</span> <span class="o">/</span> <span class="mi">10</span><span class="p">;</span>

         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">tmp</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="n">tmp</span> <span class="o">%</span> <span class="mi">2</span><span class="p">))</span>
         <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span>
               <span class="k">break</span><span class="p">;</span>
            <span class="k">else</span>
            <span class="p">{</span>
               <span class="n">printf</span><span class="p">(</span><span class="s">"noup</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
               <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
         <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">}</span>

   <span class="kt">char</span> <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
   <span class="n">scanf</span><span class="p">(</span><span class="s">"\%s"</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"still noup</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
      <span class="n">free</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">epic_function</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
      <span class="p">{</span>
         <span class="n">printf</span><span class="p">(</span><span class="s">"aaaaaaaaand stil noup</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
         <span class="n">free</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
         <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
   <span class="p">}</span>

   <span class="n">printf</span><span class="p">(</span><span class="s">"flag{\%s}</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
   <span class="n">free</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>


</div>

<div class="pagination">
  
    <a href="/2020-03-29/aoc8" class="left arrow">&#8592;</a>
  
  

  <p>
    
    <b>#reversing</b>
    
    <b>#advent-of-corona</b>
    
  </p>

  <a href="#" class="top">Top</a>
</div>

    </main>

    <footer>
  <span>
    &copy; <time datetime="2021-03-01 18:22:16 +0100">2021</time> Taras Yarema.
  </span>
</footer>

  </body>
</html>
